<main class="panel-content">
    <h3>Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ÛŒ Ù…Ù†</h3>

    <link rel="stylesheet" href="user-panel-styles.css">
    
    <button id="showAddressFormBtn" class="auth-btn btn-primary add-address-btn">
        <i class="fa fa-plus-circle"></i> Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ø¯Ø±Ø³ Ø¬Ø¯ÛŒØ¯
    </button>
    
    <div id="addressFormContainer" class="address-form-container hidden">
        <h4>Ø«Ø¨Øª Ø¢Ø¯Ø±Ø³ Ø¬Ø¯ÛŒØ¯</h4>
        <form id="addressForm" class="info-form">
            
            <div class="form-row">
                <div class="form-group">
                    <label for="city">Ø§Ø³ØªØ§Ù†:</label>
                    <input type="text" id="province" class="form-input" placeholder="Ù…Ø«Ø§Ù„: ØªÙ‡Ø±Ø§Ù†" required>
                </div>
                <div class="form-group">
                    <label for="city">Ø´Ù‡Ø±:</label>
                    <input type="text" id="city" class="form-input" placeholder="Ù…Ø«Ø§Ù„: ØªÙ‡Ø±Ø§Ù†" required>
                </div>
            </div>

            <div class="form-group full-width">
                <label for="fullAddress">Ø¢Ø¯Ø±Ø³ Ú©Ø§Ù…Ù„ Ù¾Ø³ØªÛŒ:</label>
                <textarea id="fullAddress" rows="3" class="form-input" placeholder="Ø®ÛŒØ§Ø¨Ø§Ù†ØŒ Ú©ÙˆÚ†Ù‡ØŒ Ù¾Ù„Ø§Ú©ØŒ ÙˆØ§Ø­Ø¯..." required></textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="postalCode">Ú©Ø¯ Ù¾Ø³ØªÛŒ (Û±Û° Ø±Ù‚Ù…ÛŒ):</label>
                    <input type="text" id="postalCode" class="form-input" placeholder="Ù…Ø«Ø§Ù„: Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹Û°" required>
                </div>
                <div class="form-group">
                    <label for="receiverName">Ù†Ø§Ù… Ú¯ÛŒØ±Ù†Ø¯Ù‡:</label>
                    <input type="text" id="receiverName" class="form-input" placeholder="Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ Ú¯ÛŒØ±Ù†Ø¯Ù‡" required>
                </div>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="auth-btn btn-primary">Ø°Ø®ÛŒØ±Ù‡ Ø¢Ø¯Ø±Ø³</button>
                <button type="button" id="cancelAddressBtn" class="auth-btn btn-secondary">Ø§Ù†ØµØ±Ø§Ù</button>
            </div>
        </form>
    </div>
    
    <div id="addressList" class="address-list">
        <div class="address-card" data-address-id="1">
            <div class="address-details">
                <h4>ğŸ  Ø¢Ø¯Ø±Ø³ Ù¾ÛŒØ´â€ŒÙØ±Ø¶</h4>
                <p><strong>ØªÙ‡Ø±Ø§Ù†ØŒ ØªÙ‡Ø±Ø§Ù†</strong> - Ø®ÛŒØ§Ø¨Ø§Ù† Ø´Ø±ÛŒØ¹ØªÛŒØŒ Ú©ÙˆÚ†Ù‡ Ø¨Ù‡Ø§Ø±ØŒ Ù¾Ù„Ø§Ú© Û±Û°</p>
                <p><strong>Ú¯ÛŒØ±Ù†Ø¯Ù‡:</strong> Ø¹Ù„ÛŒ Ø±Ø¶Ø§ÛŒÛŒ | <strong>Ú©Ø¯ Ù¾Ø³ØªÛŒ:</strong> Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹Û°</p>
            </div>
            <div class="address-actions">
                <button class="action-btn edit-btn"><i class="fa fa-edit"></i> ÙˆÛŒØ±Ø§ÛŒØ´</button>
                <button class="action-btn delete-btn"><i class="fa fa-trash"></i> Ø­Ø°Ù</button>
            </div>
        </div>
    </div>
    
</main>

<script src="auth.js"></script>
<script>
    // ÙØ±Ø¶ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… auth.js Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ±ÙˆØ¯/Ø®Ø±ÙˆØ¬ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯
    if (!window.isLoggedIn) {
        // Ø§Ú¯Ø± ØªØ§Ø¨Ø¹ isLoggedIn ØªØ¹Ø±ÛŒÙ Ù†Ø´Ø¯Ù‡ØŒ ÛŒÚ© placeholder Ù…ÛŒâ€ŒÚ¯Ø°Ø§Ø±ÛŒÙ…
        window.isLoggedIn = () => true; 
    }
    if (!window.isLoggedIn()) {
        window.location.href = 'login-register.html';
    }
    document.getElementById('logoutBtn').addEventListener('click', () => {
        if (window.logout) window.logout();
    });

    // --- Ù…Ù†Ø·Ù‚ Ù†Ù…Ø§ÛŒØ´/Ù¾Ù†Ù‡Ø§Ù†â€ŒØ³Ø§Ø²ÛŒ ÙØ±Ù… Ø¢Ø¯Ø±Ø³ ---
    
    const showAddressFormBtn = document.getElementById('showAddressFormBtn');
    const addressFormContainer = document.getElementById('addressFormContainer');
    const cancelAddressBtn = document.getElementById('cancelAddressBtn');
    const addressForm = document.getElementById('addressForm');
    const addressList = document.getElementById('addressList');

    // Ù†Ù…Ø§ÛŒØ´ ÙØ±Ù…
    showAddressFormBtn.addEventListener('click', () => {
        addressFormContainer.classList.remove('hidden');
        showAddressFormBtn.classList.add('hidden');
    });

    // Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† ÙØ±Ù… Ùˆ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…Ù‚Ø§Ø¯ÛŒØ±
    const hideForm = () => {
        addressFormContainer.classList.add('hidden');
        showAddressFormBtn.classList.remove('hidden');
        addressForm.reset();
    };

    cancelAddressBtn.addEventListener('click', hideForm);

    // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ø¯Ø±Ø³ (Ø¯Ø± Back-end ÙˆØ§Ù‚Ø¹ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯)
    addressForm.addEventListener('submit', (e) => {
        e.preventDefault();
        
        // Ø¯Ø±ÛŒØ§ÙØª Ù…Ù‚Ø§Ø¯ÛŒØ±
        const province = document.getElementById('province').value;
        const city = document.getElementById('city').value;
        const fullAddress = document.getElementById('fullAddress').value;
        const postalCode = document.getElementById('postalCode').value;
        const receiverName = document.getElementById('receiverName').value;
        
        // Ø´Ø¨ÛŒÙ‡ Ø³Ø§Ø²ÛŒ Ø³Ø§Ø®Øª Ú©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯
        const newAddressCard = `
            <div class="address-card" data-address-id="${Date.now()}">
                <div class="address-details">
                    <h4>ğŸ“¦ Ø¢Ø¯Ø±Ø³ Ø¬Ø¯ÛŒØ¯ Ø´Ù…Ø§</h4>
                    <p><strong>${province}ØŒ ${city}</strong> - ${fullAddress}</p>
                    <p><strong>Ú¯ÛŒØ±Ù†Ø¯Ù‡:</strong> ${receiverName} | <strong>Ú©Ø¯ Ù¾Ø³ØªÛŒ:</strong> ${postalCode}</p>
                </div>
                <div class="address-actions">
                    <button class="action-btn edit-btn"><i class="fa fa-edit"></i> ÙˆÛŒØ±Ø§ÛŒØ´</button>
                    <button class="action-btn delete-btn"><i class="fa fa-trash"></i> Ø­Ø°Ù</button>
                </div>
            </div>
        `;

        addressList.insertAdjacentHTML('afterbegin', newAddressCard);
        
        alert('Ø¢Ø¯Ø±Ø³ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯ (Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ).');
        hideForm(); 
    });

    // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø­Ø°Ù Ø¢Ø¯Ø±Ø³
    addressList.addEventListener('click', (e) => {
        if (e.target.closest('.delete-btn')) {
            if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù†ÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ø¢Ø¯Ø±Ø³ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ')) {
                e.target.closest('.address-card').remove();
            }
        }
    });

</script>